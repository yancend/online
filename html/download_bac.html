<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

    <title></title>
    <script type="text/javascript" src="lib/jquery-1.5.1.js"></script>
</head>
<body>
<form id="form" name="submitfForm" method="post" style="">
    <!--todo 给一个默认地址,配置在config 里-->

    <p>下载到本地地址
        <input id="local"
               name="localName" type="text" /></p>
</form>
<script type="text/javascript">
    var baeLoction = '';
    function checkDownload() {
        if (!$("#local")[0].value ) {
            alert("请填写完整信息");
            return;
        }
        baeLoction = $("#bae")[0].value;
        $.ajax({
            url: 'php/getRepos.php',
            type: 'post',
            data: $("#form").serialize(),
            success: function (msg) {
                if (!msg || !eval("(" + msg + ")")) {//没有返回结果或者返回false
                    //todo
//                    $("#result").attr('style',"display: block");
//                    $("#result").text(savedFailMsg);
                    return;
                }
                else {
                    var rel = eval("(" + msg + ")");
                    if(rel === true){

                        $("#nextButton").attr('disabled', "");
                        //todo
//                    $("#result").attr('style',"display: block");
//                    $("#result").text(savedSuccessMsg);
                    }else{
                        //todo
//                    $("#result").attr('style',"display: block");
//                    $("#result").text('检测未通过:\n'+rel);
                        return;
                    }

                }
            },
            error: function (xhr, msg) {
                alert("error 1");
            }
        });
    }
</script>
<button onclick="checkDownload()" style="float:left;"> 检测</button>
<div id='result' style="display: none"><p></p></div>

<button id='nextButton' disabled="disabled" onClick="window.open('./download.html?baeLoction='+baeLoction);">下一步
</button>
</body>
</html>